---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection, render } from 'astro:content';

export async function getStaticPaths() {
  const projects = await getCollection('projects');
  return projects.map(project => ({
    params: { id: project.id },
    props: { project },
  }));
}

const { project } = Astro.props;
const { Content } = await render(project);
---
<BaseLayout title={project.data.title} description={project.data.description}>
  <article class="mx-auto max-w-[800px] px-6 py-16">
    <a
      href="/projects"
      class="inline-flex items-center font-mono text-sm font-medium text-accent hover:text-accent-hover transition-colors"
    >
      &larr; back to projects
    </a>

    <div class="mt-10">
      <span class="font-mono text-[0.75em] font-medium uppercase tracking-[0.1em] text-accent">// project</span>
      <h1 class="mt-2 text-[2.2em] font-bold">{project.data.title}</h1>
    </div>
    <p class="mt-4 text-lg text-surface-500 dark:text-surface-400">
      {project.data.description}
    </p>

    {project.data.tags.length > 0 && (
      <div class="mt-4 flex flex-wrap gap-2">
        {project.data.tags.map(tag => (
          <span class="border border-accent/30 px-2 py-0.5 font-mono text-[0.7em] font-medium text-accent">
            {tag}
          </span>
        ))}
      </div>
    )}

    <div class="mt-4 flex gap-4">
      {project.data.url && (
        <a
          href={project.data.url}
          target="_blank"
          rel="noopener"
          class="font-mono text-sm font-medium text-accent hover:text-accent-hover transition-colors"
        >
          Live Site &rarr;
        </a>
      )}
      {project.data.repo && (
        <a
          href={project.data.repo}
          target="_blank"
          rel="noopener"
          class="font-mono text-sm font-medium text-surface-500 hover:text-surface-800 dark:text-surface-400 dark:hover:text-surface-200 transition-colors"
        >
          Source Code &rarr;
        </a>
      )}
    </div>

    <hr class="my-10 border-surface-200 dark:border-surface-800" />

    <div class="prose prose-zinc dark:prose-invert max-w-none prose-headings:tracking-[-0.02em] prose-a:text-accent prose-a:no-underline hover:prose-a:underline prose-code:font-mono prose-code:text-[0.9em]">
      <Content />
    </div>
  </article>
</BaseLayout>
